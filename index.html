<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Night Float Companion</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<style>
/* Your original styles (unchanged) */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{--bg0:#0a0e1a;--bg1:#0f172a;--bg2:#1a1035;--sf:rgba(255,255,255,0.04);--sfh:rgba(255,255,255,0.07);--sfa:rgba(255,255,255,0.10);--bd:rgba(255,255,255,0.08);--bdl:rgba(255,255,255,0.12);--t1:#e2e8f0;--t2:#94a3b8;--t3:#64748b;--t4:#475569;--red:#ef4444;--amber:#f59e0b;--green:#10b981;--blue:#3b82f6;--fh:'Playfair Display',Georgia,serif;--fb:'DM Sans',system-ui,sans-serif;--sw:272px;--tr:0.2s ease;}
html{font-size:15px;scroll-behavior:smooth}
body{font-family:var(--fb);background:linear-gradient(160deg,var(--bg0),var(--bg1) 40%,var(--bg2));color:var(--t1);min-height:100vh;overflow-x:hidden;line-height:1.6}
body::before,body::after{content:'';position:fixed;border-radius:50%;pointer-events:none;z-index:0;filter:blur(130px);opacity:.10}
body::before{width:600px;height:600px;background:#6366f1;top:-200px;left:-100px}
body::after{width:500px;height:500px;background:#a855f7;bottom:-150px;right:-100px}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:3px}
#root{position:relative;z-index:1}
.lyt{display:flex;min-height:100vh}
.sb{width:var(--sw);min-height:100vh;position:fixed;top:0;left:0;background:rgba(10,14,26,.93);backdrop-filter:blur(20px);border-right:1px solid var(--bd);z-index:100;display:flex;flex-direction:column;transition:transform .3s ease;overflow-y:auto}
.sb-hd{padding:22px 18px 14px;border-bottom:1px solid var(--bd)}
.sb-brand{font-family:var(--fh);font-weight:800;font-size:1.2rem;background:linear-gradient(135deg,#e2e8f0,#c7d2fe,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.3}
.sb-tag{font-size:.68rem;color:var(--t3);margin-top:3px;letter-spacing:.5px;text-transform:uppercase}
.sb-srch{padding:10px 14px}
.sb-srch input{width:100%;padding:7px 11px;border-radius:8px;background:var(--sf);border:1px solid var(--bd);color:var(--t1);font-family:var(--fb);font-size:.84rem;outline:none;transition:var(--tr)}
.sb-srch input:focus{border-color:#6366f1;background:var(--sfh)}
.sb-srch input::placeholder{color:var(--t4)}
.sb-nav{flex:1;padding:2px 8px 20px;overflow-y:auto}
.ni{display:flex;align-items:center;gap:9px;padding:8px 11px;border-radius:8px;cursor:pointer;transition:var(--tr);font-size:.83rem;color:var(--t2);line-height:1.35;margin-bottom:1px;position:relative;user-select:none}
.ni:hover{background:var(--sfh);color:var(--t1)}
.ni.act{background:var(--sfa);color:var(--t1)}
.ni.act::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:18px;border-radius:0 3px 3px 0}
.ndot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.mn{flex:1;margin-left:var(--sw);padding:28px 36px 60px;max-width:880px}
.mhd{display:none;position:fixed;top:0;left:0;right:0;z-index:90;background:rgba(10,14,26,.95);backdrop-filter:blur(16px);border-bottom:1px solid var(--bd);padding:11px 14px;align-items:center;gap:12px}
.hbg{background:none;border:none;color:var(--t1);cursor:pointer;padding:4px}
.hbg svg{width:24px;height:24px}
.ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:95}.ov.sh{display:block}
@media(max-width:768px){.mhd{display:flex}.sb{transform:translateX(-100%)}.sb.op{transform:translateX(0)}.mn{margin-left:0;padding:68px 14px 40px}}
.hero{text-align:center;padding:70px 16px 50px}
.hero-t{font-family:var(--fh);font-weight:900;font-size:clamp(2rem,5vw,3rem);background:linear-gradient(135deg,#e2e8f0 0%,#c7d2fe 50%,#a78bfa 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.2;margin-bottom:10px}
.hero-s{color:var(--t2);font-size:1rem;max-width:480px;margin:0 auto 36px}
.tgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:14px}
.tc{background:var(--sf);border:1px solid var(--bd);border-radius:13px;padding:18px;cursor:pointer;transition:all .2s ease;position:relative;overflow:hidden}
.tc:hover{transform:translateY(-3px);border-color:var(--bdl)}
.tc-ac{height:3px;border-radius:3px;margin-bottom:12px;width:36px}
.tc h3{font-family:var(--fh);font-weight:700;font-size:1rem;margin-bottom:5px;line-height:1.3}
.tc-tags{display:flex;flex-wrap:wrap;gap:4px;margin-top:8px}
.tc-tag{font-size:.65rem;padding:2px 7px;border-radius:10px;background:var(--sf);color:var(--t3)}
.tc-dt{font-size:.65rem;color:var(--t4);margin-top:6px}
.td{animation:fi .25s ease}
@keyframes fi{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.bk{display:inline-flex;align-items:center;gap:5px;padding:5px 12px;border-radius:7px;background:var(--sf);border:1px solid var(--bd);color:var(--t2);cursor:pointer;font-size:.8rem;font-family:var(--fb);transition:var(--tr);margin-bottom:18px}
.bk:hover{background:var(--sfh);color:var(--t1)}
.tt-bar{margin-bottom:24px}
.tt-bar h1{font-family:var(--fh);font-weight:800;font-size:clamp(1.5rem,4vw,2rem);line-height:1.25;margin-bottom:8px}
.tt-meta{display:flex;flex-wrap:wrap;gap:5px}
.tt-tag{font-size:.68rem;padding:2px 9px;border-radius:11px}
.stabs{display:flex;flex-wrap:wrap;gap:2px;margin-bottom:22px;border-bottom:1px solid var(--bd);padding-bottom:0}
.stab{padding:7px 13px;border:none;background:none;color:var(--t3);cursor:pointer;font-family:var(--fb);font-size:.78rem;font-weight:600;border-bottom:2px solid transparent;transition:var(--tr);white-space:nowrap}
.stab:hover{color:var(--t2)}.stab.act{color:var(--t1)}
.bl{list-style:none;padding:0}.bl li{padding:9px 0;border-bottom:1px solid var(--bd);font-size:.88rem;line-height:1.65;color:var(--t2)}
.bl li:last-child{border-bottom:none}.bl li strong,.bl li b{color:var(--t1);font-weight:600}
.sec-panic{background:rgba(239,68,68,.05);border:1px solid rgba(239,68,68,.13);border-radius:11px;padding:18px}
.sec-panic .badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:7px;background:rgba(239,68,68,.13);color:#fca5a5;font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.sec-icu{background:rgba(245,158,11,.05);border:1px solid rgba(245,158,11,.11);border-radius:11px;padding:18px}
.sec-icu .badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:7px;background:rgba(245,158,11,.13);color:#fcd34d;font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.sec-ord{background:rgba(99,102,241,.04);border:1px solid rgba(99,102,241,.11);border-radius:11px;padding:18px}
.sec-ord .badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:7px;background:rgba(99,102,241,.13);color:#a5b4fc;font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.sec-cdi{background:rgba(20,184,166,.04);border:1px solid rgba(20,184,166,.11);border-radius:11px;padding:18px}
.sec-cdi .badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:7px;background:rgba(20,184,166,.13);color:#5eead4;font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px}
.qc{background:var(--sf);border:1px solid var(--bd);border-radius:11px;padding:20px;margin-bottom:14px}
.ql{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px}
.qs{font-size:.9rem;line-height:1.7;color:var(--t2);margin-bottom:14px}
.qopts{list-style:none;padding:0}
.qo{display:flex;align-items:flex-start;gap:9px;padding:9px 12px;border-radius:7px;cursor:pointer;transition:var(--tr);margin-bottom:5px;border:1px solid transparent;font-size:.86rem;color:var(--t2)}
.qo:hover{background:var(--sfh)}
.qo.sel{border-color:var(--bdl);background:var(--sfa)}
.qo.cor{border-color:#10b981;background:rgba(16,185,129,.1);color:#6ee7b7}
.qo.inc{border-color:#ef4444;background:rgba(239,68,68,.07);color:#fca5a5}
.qol{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:700;flex-shrink:0;background:var(--sf);border:1px solid var(--bd)}
.qo.cor .qol{background:rgba(16,185,129,.2);border-color:#10b981}
.qo.inc .qol{background:rgba(239,68,68,.13);border-color:#ef4444}
.qrb{display:inline-flex;padding:7px 16px;border-radius:7px;border:1px solid var(--bd);background:var(--sf);color:var(--t2);cursor:pointer;font-family:var(--fb);font-size:.8rem;font-weight:600;transition:var(--tr);margin-top:6px}
.qrb:hover{background:var(--sfh)}
.qex{margin-top:12px;padding:12px;border-radius:7px;background:rgba(16,185,129,.05);border:1px solid rgba(16,185,129,.11);font-size:.85rem;line-height:1.65;color:var(--t2)}
.fc{background:var(--sf);border:1px solid var(--bd);border-radius:11px;padding:16px;margin-bottom:9px;cursor:pointer;transition:var(--tr)}
.fc:hover{border-color:var(--bdl)}
.fc-q{font-size:.88rem;color:var(--t1);font-weight:500}
.fc-a{margin-top:9px;padding-top:9px;border-top:1px solid var(--bd);font-size:.85rem;color:var(--t2);line-height:1.6}
.ri{padding:7px 0;border-bottom:1px solid var(--bd)}.ri:last-child{border-bottom:none}
.ri a{color:#818cf8;text-decoration:none;font-size:.85rem;transition:var(--tr)}.ri a:hover{color:#a5b4fc;text-decoration:underline}
.stats{display:flex;gap:18px;flex-wrap:wrap;margin-bottom:28px;padding:14px 18px;background:var(--sf);border-radius:11px;border:1px solid var(--bd)}
.stat{text-align:center}.stat-n{font-size:1.4rem;font-weight:700;font-family:var(--fh)}.stat-l{font-size:.68rem;color:var(--t3);text-transform:uppercase;letter-spacing:.5px}
.shop-modal{position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:1000;display:flex;align-items:center;justify-content:center}
.shop-content{background:#0f172a;border:2px solid #67e8f9;border-radius:16px;width:92%;max-width:580px;max-height:90vh;overflow:auto}
.shop-header{padding:20px 24px;border-bottom:1px solid #334155;display:flex;justify-content:space-between;align-items:center}
.shop-grid{padding:24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:16px}
.shop-item{background:#1e2937;border:1px solid #475569;border-radius:12px;padding:12px;text-align:center;cursor:pointer;transition:all .2s}
.shop-item:hover{border-color:#67e8f9;transform:translateY(-2px)}
.shop-item.locked{opacity:0.6;cursor:not-allowed}
.coin-balance{font-size:1.4rem;font-weight:700;color:#eab308}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useMemo,useEffect}=React;

const ACCENT=["#6366f1","#a855f7","#ec4899","#f97316","#14b8a6","#3b82f6","#8b5cf6","#ef4444","#10b981","#f59e0b"];

let TOPICS = [];

const LEVELS = [
  {level:1, name:"Pager Puppy", xpRequired:0, nextName:"Shadow Intern"},
  {level:2, name:"Shadow Intern", xpRequired:750, nextName:"Night Rookie"},
  {level:3, name:"Night Rookie", xpRequired:2250, nextName:"Electrolyte Enforcer"},
  {level:4, name:"Electrolyte Enforcer", xpRequired:4500, nextName:"Sepsis Slayer"},
  {level:5, name:"Sepsis Slayer", xpRequired:7500, nextName:"Code Blue Cowboy"},
  {level:6, name:"Code Blue Cowboy", xpRequired:11250, nextName:"Hypo/Hyper Hero"},
  {level:7, name:"Hypo/Hyper Hero", xpRequired:15750, nextName:"Senior Nocturnist"},
  {level:8, name:"Senior Nocturnist", xpRequired:21000, nextName:"Moonlight Master"},
  {level:9, name:"Moonlight Master", xpRequired:27000, nextName:"Legend of the Night Float"},
  {level:10, name:"Legend of the Night Float", xpRequired:34000, nextName:"MAX"}
];

const BADGES = [ /* the 32 badges from earlier */ ];

const SHOP_ITEMS = [ /* the shop items from earlier */ ];

function getCurrentLevel(xp) {
  return LEVELS.find(l => xp >= l.xpRequired) || LEVELS[0];
}

function NightMonitor({totalXP, coins, onProfile, onShop}) {
  const lvl = getCurrentLevel(totalXP);
  const next = LEVELS.find(l => l.level === lvl.level + 1) || LEVELS[LEVELS.length-1];
  const progress = Math.min(100, ((totalXP - lvl.xpRequired) / (next.xpRequired - lvl.xpRequired)) * 100);

  return <div className="bg-zinc-900 border border-cyan-400/30 rounded-2xl p-5 mb-4 shadow-2xl">
    <div className="flex justify-between items-center mb-3">
      <div className="flex items-center gap-3 cursor-pointer" onClick={onProfile}>
        <span className="text-4xl">ðŸ¦‰</span>
        <div>
          <div className="text-cyan-300 font-bold text-xl tracking-tight">{lvl.name}</div>
          <div className="text-zinc-400 text-xs">LEVEL {lvl.level}</div>
        </div>
      </div>
      <div className="text-right">
        <div className="text-emerald-400 font-mono text-2xl font-bold">{totalXP.toLocaleString()}</div>
        <div className="text-xs text-zinc-500">XP</div>
      </div>
    </div>
    <div className="relative h-8 bg-zinc-800 rounded-full overflow-hidden border border-cyan-500/40 shadow-inner">
      <div className="absolute inset-0 bg-gradient-to-r from-purple-500 via-cyan-400 to-emerald-400 transition-all duration-1000" style={{width: progress + '%'}}></div>
      <div className="absolute top-1/2 -translate-y-1/2 text-4xl transition-all duration-1000" style={{left: `calc(${progress}% - 22px)`}}>ðŸ¦‰</div>
    </div>
    <div className="flex justify-between text-xs mt-3">
      <div className="text-zinc-500">{next.xpRequired - totalXP} XP to {next.nextName}</div>
      <div className="flex items-center gap-1 text-amber-400 cursor-pointer" onClick={onShop}>
        <span>ðŸª™</span> {coins}
      </div>
    </div>
  </div>;
}

function ProfileModal({totalXP, unlockedBadges, onClose}) {
  const lvl = getCurrentLevel(totalXP);
  return <div style={{position:'fixed',inset:0,background:'rgba(0,0,0,0.9)',z-index:999,display:'flex',alignItems:'center',justifyContent:'center'}} onClick={onClose}>
    <div style={{background:'#0f172a',border:'2px solid #67e8f9',borderRadius:16,maxWidth:560,width:'92%',maxHeight:'92vh',overflow:'auto'}} onClick={e=>e.stopPropagation()}>
      <div style={{padding:24}}>
        <NightMonitor totalXP={totalXP} coins={0} onProfile={()=>{}} onShop={()=>{}} />
        <div style={{marginTop:24,display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(90px,1fr))',gap:12}}>
          {BADGES.map(b => {
            const unlocked = unlockedBadges.includes(b.id);
            return <div key={b.id} style={{textAlign:'center',opacity:unlocked?1:0.4}}>
              <div style={{fontSize:48,filter:unlocked?'none':'grayscale(1)'}}>{b.icon}</div>
              <div style={{fontSize:13,fontWeight:700,marginTop:4,color:unlocked?'#67e8f9':'#64748b'}}>{b.name}</div>
            </div>;
          })}
        </div>
      </div>
    </div>
  </div>;
}

function ShopModal({coins, purchased, onBuy, onClose}) {
  return <div className="shop-modal" onClick={onClose}>
    <div className="shop-content" onClick={e=>e.stopPropagation()}>
      <div className="shop-header">
        <div style={{fontSize:24,fontWeight:800,color:'#67e8f9'}}>Night Coins Shop</div>
        <div className="coin-balance">ðŸª™ {coins}</div>
      </div>
      <div className="shop-grid">
        {SHOP_ITEMS.map(item => {
          const owned = purchased.includes(item.id);
          return <div key={item.id} className={`shop-item ${owned?'locked':''}`} onClick={() => !owned && onBuy(item)}>
            <div style={{fontSize:48}}>{item.icon}</div>
            <div style={{fontSize:14,fontWeight:700,marginTop:8}}>{item.name}</div>
            <div style={{fontSize:13,color:'#eab308',marginTop:4}}>ðŸª™ {item.price}</div>
          </div>;
        })}
      </div>
    </div>
  </div>;
}

function App(){
  const [sel,setSel]=useState(null);
  const [q,setQ]=useState('');
  const [sbOpen,setSbOpen]=useState(false);

  const [totalXP, setTotalXP] = useState(() => parseInt(localStorage.getItem('nf_xp') || '0'));
  const [unlockedBadges, setUnlockedBadges] = useState(() => JSON.parse(localStorage.getItem('nf_badges') || '[]'));
  const [coins, setCoins] = useState(() => parseInt(localStorage.getItem('nf_coins') || '0'));
  const [purchased, setPurchased] = useState(() => JSON.parse(localStorage.getItem('nf_purchased') || '[]'));
  const [showProfile, setShowProfile] = useState(false);
  const [showShop, setShowShop] = useState(false);
  const [topics, setTopics] = useState([]);
  const [loaded, setLoaded] = useState(false);

  useEffect(() => {
    fetch('./topics.json')
      .then(r => r.json())
      .then(data => {
        setTopics(data);
        setLoaded(true);
      });
  }, []);

  if (!loaded) {
    return <div style={{height:'100vh',display:'flex',alignItems:'center',justifyContent:'center',background:'#0a0e1a',color:'#67e8f9',fontSize:'1.5rem'}}>Loading Night Float Companion...</div>;
  }

  // the rest of your App component with topics = topics
  const filtered=useMemo(()=>{
    if(!q.trim())return topics;
    const lq=q.toLowerCase();
    return topics.filter(t=>t.title.toLowerCase().includes(lq)||t.tags.some(tg=>tg.toLowerCase().includes(lq)));
  },[q,topics]);

  // ... (the rest of the App component with awardXP, ProfileModal, ShopModal, etc. from the previous version)

  return (
    <div className="lyt">
      {/* the rest of your UI */}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
